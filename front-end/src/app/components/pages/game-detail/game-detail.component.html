@if (game) {
  <div class="game-detail">
    <!-- CABECERA: solo la imagen -->
    <div class="header">
      <img [src]="game.background_image" [alt]="game.name" class="cover" />
    </div>

    <!-- INFO DEL JUEGO -->
    <div class="info">
      <h1>{{ game.name }}</h1>
    
      <div class="icons">

        <app-game-actions
        class="icons"
        [game]="game"
        ></app-game-actions>
        
        <button class="btn-review" (click)="modalManager.openReviewModal(game)" [disabled]="!game">
          <img src="/assets/images/icons/pencil.svg" alt=""> Review
        </button>
      </div>
    </div>

    <!-- DESCRIPCIÓN -->
    <div class="description">
      <div class="description-content">
        <div class="text">
          <p [innerHTML]="game.description"></p>
        </div>
        <div class="media-info">
          <div class="image">
            <img [src]="game.background_image" [alt]="game.name" />
          </div>
          
          <!-- RATING -->
          @if(game.rating) {
            <p class="rating">
              Community rating: <span>{{ game.rating }}</span>
              <img class="star" src="../../../assets/images/icons/star-filled.svg" alt="⭐">
            </p>
          }
          
          <!-- DURATION -->
          @if (game.playtime && game.playtime > 0) {
            <p class="duration">
              Average playtime: <span>{{ game.playtime }} hours</span>
            </p>
          }

        </div>
      </div>
    </div>


    <!-- ADDITIONAL INFO -->
    <div class="additional-info">
      <div class="info-item">
        <h3>Release Date</h3>
        <p>{{ game.released || 'N/A' }}</p>
      </div>

      <div class="info-item">
        <h3>Genres</h3>
        <p>
          @for (g of game.genres; track g) {
            {{ g.name }}@if (!$last) {, }
          }
        </p>
      </div>

      <div class="info-item">
        <h3>Developers</h3>
        <p>
          @for (d of game.developers; track d) {
            {{ d.name }}@if (!$last) {, }
          }
        </p>
      </div>

      <div class="info-item">
        <h3>Publishers</h3>
        <p>
          @for (p of game.publishers; track p) {
            {{ p.name }}@if (!$last) {, }
          }
        </p>
      </div>

      @if (game.website) {
        <div class="info-item">
          <h3>Official Site</h3>
          <p><a [href]="game.website" target="_blank">{{ game.website }}</a></p>
        </div>
      }

      @if (game.stores && game.stores.length > 0) {
        <div class="info-item">
          <h3>Buy On</h3>
          <p>
            @for (store of game.stores; track store) {
              <a [href]="store.url" target="_blank">{{ store.store.name }}</a>
              @if (!$last) {, }
            }
          </p>
        </div>
      }
    </div>
  </div>
} @else {
  <p>Loading game details...</p>
}


<!-- USER REVIEWS -->

<div class="reviews">

  <div class="reviews-header">
    <h2>Reviews</h2>
    
    @if (reviews.length > 4) {
      <button class="see-all" (click)="showAll = true">
        See all reviews →
      </button>
    }
  </div>
  
  @if (!showAll) {
    
    @if (limitedReviews.length === 0) {
      <p>No reviews yet.</p>
    } @else {
      
      <div class="reviews-grid">
        @for (r of limitedReviews; track r) {
          <div class="review-card">
            <h4>{{ r.username }}</h4>
            <small class="date">{{ r.createdAt | date:'mediumDate' }}</small>
            
            @if (r.rating) {
              <p class="rating">
                Rating: <strong>{{ r.rating }}</strong>/10
              </p>
            }
            
            @if (r.playtime) {
              <p class="playtime">
                Played: {{ r.playtime }} hours
              </p>
            }
            
            <p class="comment">"{{ r.review }}"</p>
          </div>
        }
      </div>
      
    }
    
  } @else {
    
    <!-- Vista expandida -->
    <div class="reviews-list">
      @for (r of reviews; track r) {
        <div class="review-card expanded">
          <h4>{{ r.username }}</h4>
          <small class="date">{{ r.createdAt }}</small>
          <p>{{ r.review }}</p>
        </div>
      }
    </div>
    
  }
</div>